---
title: "Entropy Visualization"
author: "Chris Bentz"
date: "18/02/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Session Info
Give the session info (reduced).
```{r, echo = F}
# R version
sessionInfo()$R.version$version.string
# platform
sessionInfo()$R.version$platform 
```

## Load libraries
If the libraries are not installed yet, you need to install them using, for example, the command: install.packages("ggplot2").
```{r, message = F}
library(ggplot2)
library(ggrepel)
library(dplyr)
```
## Load Data
Load unigram, bigram and trigram estimations which were generated in EntropyEstimation.Rmd, as well as the neural net estimations generated by EntropyRate.ipynb.
```{r}
h.est <- read.csv(file = "~/Github/Workshop_DGfS2022/Results/Application1/entropyEstimations.csv")
head(h.est)
h.neural.est <- read.csv(file = "~/Github/Workshop_DGfS2022/Results/Application1/entropyRate.csv")
head(h.neural.est)
```

## Merge Data Frames
Merge the two data frames together for plotting in one panel.
```{r}
# remove first to columns, since these are redundant.
h.neural.est.short <- select(h.neural.est, id:hrate.trigrams)
# merge data frames by id
h.est.combined <- merge(h.est, h.neural.est.short, by = "id")
```

## Scatterplots
Create scatterplots with entropy estimations on the x-axis and y-axis. This gives a visual impression where each text resides in terms of estimated entropies.
```{r}
h.unigram.plot <- ggplot(h.est.combined, aes(x = h.unigrams, y = hrate.unigrams, 
                                        colour = subcorpus)) + 
  geom_point(alpha = 0.8, size  = 1) +
  geom_rug() +
  geom_label_repel(aes(label = id), label.size = 0.2, size = 3) + 
  labs(x = "Unigram Entropy for Characters (ML Estimate)", 
       y = "Unigram Entropy for Characters (Neural Estimate)")
h.unigram.plot
```

```{r}
h.trigram.plot <- ggplot(h.est.combined, aes(x = h.trigrams, y = hrate.trigrams, 
                                        colour = subcorpus)) + 
  geom_point(alpha = 0.8, size  = 1) +
  geom_rug() +
  geom_label_repel(aes(label = id), label.size = 0.2, size = 3) + 
  labs(x = "Trigram Entropy for Characters (ML Estimate)", 
       y = "Trigram Entropy for Characters (Neural Estimate)") 
h.trigram.plot
```

## Safe Figures
Safe complete figures to file.
```{r}
# unigrams
ggsave("~/Github/Workshop_DGfS2022/Figures/UnigramEntropyPlot.pdf", h.unigram.plot, dpi = 300, 
       scale = 1, device = cairo_pdf)
#trigrams
ggsave("~/Github/Workshop_DGfS2022/Figures/TrigramEntropyPlot.pdf", h.trigram.plot, dpi = 300, 
       scale = 1, device = cairo_pdf)
```